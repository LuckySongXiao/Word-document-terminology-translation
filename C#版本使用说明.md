# C#版本多格式文档翻译助手使用说明

## 🚀 启动程序

### 方法一：使用命令行
```bash
dotnet run
```

### 方法二：使用批处理文件
```bash
run_csharp_version.bat
```

### 方法三：运行编译后的程序
```bash
dotnet run --project DocumentTranslator.csproj
```

## 📝 主要功能

### 1. 文档翻译
- **支持格式**: Word (.docx), PDF, Excel (.xlsx), PowerPoint (.pptx)
- **翻译引擎**: 支持多种AI翻译引擎
- **输出选项**: 双语对照或仅翻译结果
- **术语库**: 支持专业术语翻译

### 2. 术语库编辑器 📚

#### 启动术语库编辑器
1. 在主界面点击 **"📝 打开术语库编辑器"** 按钮
2. 术语库编辑器窗口将打开

#### 术语库编辑器功能

##### 📋 术语列表
- 左侧显示所有术语的列表
- 显示中文术语和预览信息
- 支持点击选择术语进行编辑

##### 🔍 搜索和筛选
- **搜索框**: 输入关键词搜索中文术语或翻译
- **语言筛选**: 按特定语言筛选术语
- 支持的语言：英语、日语、韩语、法语、德语、西班牙语、意大利语、俄语

##### ✏️ 术语编辑
- **中文术语**: 输入或修改中文术语
- **分类**: 选择或输入术语分类
- **多语言翻译**: 为每种语言添加翻译和备注

##### 🔧 操作功能
- **➕ 添加术语**: 创建新的术语条目
- **💾 保存术语**: 保存当前编辑的术语
- **🗑️ 删除术语**: 删除选中的术语
- **🔄 重置**: 重置当前术语的编辑内容

##### 📁 导入导出
- **导入**: 支持JSON和CSV格式
- **导出**: 支持JSON和CSV格式
- **💾 保存**: 保存整个术语库

#### 术语库数据格式

##### JSON格式示例
```json
{
  "英语": {
    "术语1": "translation1",
    "术语2": {
      "term": "translation2",
      "note": "备注信息"
    }
  },
  "日语": {
    "术语1": "翻訳1"
  }
}
```

##### CSV格式
- 列标题：中文,英语,日语,韩语,法语,德语,西班牙语,意大利语,俄语,分类
- 每行一个术语

## ⚙️ 翻译选项

### 基本选项
- **✅ 使用术语库进行翻译**: 启用专业术语翻译
- **⚡ 使用术语预处理**: 提高术语翻译准确性
- **📑 同时导出PDF文件**: 翻译完成后导出PDF

### 输出格式
- **📋 双语对照显示**: 原文和译文并排显示
- **📝 仅显示翻译结果**: 只显示翻译后的内容

## 🔧 引擎配置

点击 **"⚙️ 引擎配置"** 按钮可以：
- 配置不同的AI翻译引擎
- 设置API密钥和参数
- 选择翻译模型

## 📊 当前术语库状态

根据测试结果，当前术语库包含：
- **英语**: 162条术语
- **其他语言**: 暂无术语（可通过编辑器添加）

## 🛠️ 故障排除

### 术语库编辑器问题
1. **术语列表为空**
   - 检查 `data/terminology.json` 文件是否存在
   - 确认文件格式正确
   - 尝试重新启动程序

2. **搜索功能异常**
   - 清空搜索框重试
   - 重置语言筛选器为"全部"

3. **保存失败**
   - 检查文件权限
   - 确认磁盘空间充足
   - 查看错误提示信息

### 程序启动问题
1. **依赖项缺失**
   ```bash
   dotnet restore
   ```

2. **编译错误**
   ```bash
   dotnet build DocumentTranslator.csproj
   ```

## 📝 使用建议

1. **定期备份术语库**: 程序会自动创建 `terminology.json.backup`
2. **分类管理术语**: 使用分类功能组织术语
3. **添加备注**: 为复杂术语添加使用说明
4. **测试翻译**: 添加新术语后测试翻译效果

## 🔄 版本信息

- **版本**: v3.1
- **框架**: .NET 6.0
- **UI**: WPF
- **支持平台**: Windows

## 📞 技术支持

如遇到问题，请检查：
1. 程序日志文件
2. 术语库文件完整性
3. 系统环境配置

---

**注意**: 程序首次启动可能需要较长时间，请耐心等待。
