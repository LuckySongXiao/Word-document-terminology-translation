@echo off
chcp 65001 >nul
title å¤šæ ¼å¼æ–‡æ¡£ç¿»è¯‘åŠ©æ‰‹ - è°ƒè¯•ç‰ˆå°è£…ï¼ˆå¸¦æŽ§åˆ¶å°ï¼‰

echo.
echo ================================================================================
echo                    å¤šæ ¼å¼æ–‡æ¡£ç¿»è¯‘åŠ©æ‰‹ v3.1 - è°ƒè¯•ç‰ˆå°è£…
echo ================================================================================
echo.
echo ðŸ“‹ è°ƒè¯•ç‰ˆç‰¹æ€§:
echo âœ… æ˜¾ç¤ºæŽ§åˆ¶å°çª—å£ï¼Œä¾¿äºŽæŸ¥çœ‹å¼‚å¸¸æŠ¥é”™
echo âœ… è¯¦ç»†çš„è°ƒè¯•æ—¥å¿—è¾“å‡º
echo âœ… å®žæ—¶é”™è¯¯ä¿¡æ¯æ˜¾ç¤º
echo âœ… åŒ…å«æ‰€æœ‰æœ€æ–°ä¿®å¤
echo âœ… å•æ–‡ä»¶éƒ¨ç½²ï¼Œæ— éœ€å®‰è£…
echo.

:: æ£€æŸ¥å½“å‰è™šæ‹ŸçŽ¯å¢ƒ
echo ðŸ” æ£€æŸ¥å½“å‰çŽ¯å¢ƒ...
if "%CONDA_DEFAULT_ENV%"=="" (
    echo âŒ é”™è¯¯: æœªæ£€æµ‹åˆ°condaè™šæ‹ŸçŽ¯å¢ƒ
    echo è¯·å…ˆæ¿€æ´»wordè™šæ‹ŸçŽ¯å¢ƒ: conda activate word
    pause
    exit /b 1
)

echo âœ… å½“å‰è™šæ‹ŸçŽ¯å¢ƒ: %CONDA_DEFAULT_ENV%
echo.

:: ç¡®è®¤å¼€å§‹æž„å»º
echo ðŸ“¦ å‡†å¤‡å¼€å§‹è°ƒè¯•ç‰ˆæœ¬æž„å»º...
echo æ³¨æ„: è°ƒè¯•ç‰ˆæœ¬æž„å»ºå¯èƒ½éœ€è¦10-15åˆ†é’Ÿï¼Œè¯·ç¡®ä¿:
echo   - ç½‘ç»œè¿žæŽ¥æ­£å¸¸
echo   - æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´ (è‡³å°‘2GB)
echo   - å…³é—­æ€æ¯’è½¯ä»¶çš„å®žæ—¶ä¿æŠ¤
echo.
echo âš ï¸  è°ƒè¯•ç‰ˆæœ¬ç‰¹ç‚¹:
echo   - ä¼šæ˜¾ç¤ºæŽ§åˆ¶å°çª—å£ï¼Œä¾¿äºŽæŸ¥çœ‹è¯¦ç»†çš„è¿è¡Œæ—¥å¿—
echo   - æ‰€æœ‰å¼‚å¸¸å’Œé”™è¯¯éƒ½ä¼šåœ¨æŽ§åˆ¶å°ä¸­æ˜¾ç¤º
echo   - ä¸»è¦ç”¨äºŽé—®é¢˜è¯Šæ–­å’Œè°ƒè¯•
echo.
set /p confirm="ç¡®è®¤å¼€å§‹æž„å»ºè°ƒè¯•ç‰ˆæœ¬? (y/n): "
if /i not "%confirm%"=="y" (
    echo æž„å»ºå·²å–æ¶ˆ
    pause
    exit /b 0
)

echo.
echo ðŸš€ å¼€å§‹æž„å»ºè°ƒè¯•ç‰ˆæœ¬...
echo.

:: æ‰§è¡Œæž„å»º
python build_with_console.py

:: æ£€æŸ¥æž„å»ºç»“æžœ
if %errorlevel% equ 0 (
    echo.
    echo ================================================================================
    echo                              ðŸŽ‰ è°ƒè¯•ç‰ˆæž„å»ºæˆåŠŸå®Œæˆ!
    echo ================================================================================
    echo.
    echo ðŸ“ å‘å¸ƒæ–‡ä»¶ä½ç½®: release\å¤šæ ¼å¼æ–‡æ¡£ç¿»è¯‘åŠ©æ‰‹_è°ƒè¯•ç‰ˆ_v3.1_[æ—¥æœŸ]
    echo ðŸš€ å¯æ‰§è¡Œæ–‡ä»¶: å¤šæ ¼å¼æ–‡æ¡£ç¿»è¯‘åŠ©æ‰‹_è°ƒè¯•ç‰ˆ_v3.1.exe
    echo.
    echo ðŸ“‹ è°ƒè¯•ç‰ˆç‰¹æ€§:
    echo âœ… æ˜¾ç¤ºæŽ§åˆ¶å°çª—å£ - å¯ä»¥çœ‹åˆ°è¯¦ç»†çš„è¿è¡Œæ—¥å¿—å’Œé”™è¯¯ä¿¡æ¯
    echo âœ… å®žæ—¶é”™è¯¯è¾“å‡º - æ‰€æœ‰å¼‚å¸¸éƒ½ä¼šåœ¨æŽ§åˆ¶å°ä¸­æ˜¾ç¤º
    echo âœ… è°ƒè¯•ä¿¡æ¯å®Œæ•´ - åŒ…å«è¯¦ç»†çš„ç³»ç»ŸçŠ¶æ€å’Œå¤„ç†è¿‡ç¨‹
    echo âœ… ä¾¿äºŽé—®é¢˜å®šä½ - å‡ºçŽ°é—®é¢˜æ—¶å¯ä»¥ç›´æŽ¥æŸ¥çœ‹æŽ§åˆ¶å°ä¿¡æ¯
    echo.
    echo ðŸ“‹ ä½¿ç”¨æ–¹æ³•:
    echo 1. åŒå‡»è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶
    echo 2. ç¨‹åºä¼šæ˜¾ç¤ºä¸¤ä¸ªçª—å£ï¼šæŽ§åˆ¶å°çª—å£å’Œå¯åŠ¨å™¨çª—å£
    echo 3. æŽ§åˆ¶å°çª—å£æ˜¾ç¤ºè¯¦ç»†æ—¥å¿—ï¼Œå¯åŠ¨å™¨çª—å£ç”¨äºŽæ“ä½œ
    echo 4. å¦‚æžœå‡ºçŽ°é—®é¢˜ï¼Œè¯·æŸ¥çœ‹æŽ§åˆ¶å°çª—å£ä¸­çš„é”™è¯¯ä¿¡æ¯
    echo.
    echo âš ï¸  æ³¨æ„äº‹é¡¹:
    echo â€¢ è¯·ä¸è¦å…³é—­æŽ§åˆ¶å°çª—å£ï¼Œå¦åˆ™ç¨‹åºä¼šé€€å‡º
    echo â€¢ æŽ§åˆ¶å°çª—å£ä¸­çš„ä¿¡æ¯å¯¹äºŽé—®é¢˜è¯Šæ–­éžå¸¸é‡è¦
    echo â€¢ å¦‚æžœé‡åˆ°é—®é¢˜ï¼Œè¯·æˆªå›¾ä¿å­˜æŽ§åˆ¶å°ä¸­çš„é”™è¯¯ä¿¡æ¯
    echo â€¢ æœ¬ç‰ˆæœ¬ä¸»è¦ç”¨äºŽè°ƒè¯•ï¼Œæ­£å¼ä½¿ç”¨å»ºè®®ä½¿ç”¨æ ‡å‡†ç‰ˆæœ¬
    echo.
    echo ðŸ“‹ ä¸‹ä¸€æ­¥:
    echo 1. æµ‹è¯•è°ƒè¯•ç‰ˆå¯æ‰§è¡Œæ–‡ä»¶æ˜¯å¦æ­£å¸¸å¯åŠ¨
    echo 2. éªŒè¯æŽ§åˆ¶å°æ˜¯å¦æ˜¾ç¤ºè¯¦ç»†çš„è¿è¡Œä¿¡æ¯
    echo 3. æµ‹è¯•ç¿»è¯‘åŠŸèƒ½å¹¶è§‚å¯ŸæŽ§åˆ¶å°æ—¥å¿—
    echo 4. å¦‚æžœå‘çŽ°é—®é¢˜ï¼Œè®°å½•æŽ§åˆ¶å°ä¸­çš„é”™è¯¯ä¿¡æ¯
    echo.
) else (
    echo.
    echo ================================================================================
    echo                              âŒ è°ƒè¯•ç‰ˆæž„å»ºå¤±è´¥
    echo ================================================================================
    echo.
    echo è¯·æ£€æŸ¥ä¸Šæ–¹çš„é”™è¯¯ä¿¡æ¯ï¼Œå¸¸è§é—®é¢˜:
    echo 1. ç½‘ç»œè¿žæŽ¥é—®é¢˜å¯¼è‡´ä¾èµ–ä¸‹è½½å¤±è´¥
    echo 2. ç£ç›˜ç©ºé—´ä¸è¶³
    echo 3. æ€æ¯’è½¯ä»¶æ‹¦æˆª
    echo 4. PythonçŽ¯å¢ƒé—®é¢˜
    echo 5. è™šæ‹ŸçŽ¯å¢ƒæœªæ­£ç¡®æ¿€æ´»
    echo.
    echo è§£å†³æ–¹æ³•:
    echo 1. æ£€æŸ¥ç½‘ç»œè¿žæŽ¥
    echo 2. æ¸…ç†ç£ç›˜ç©ºé—´
    echo 3. ä¸´æ—¶å…³é—­æ€æ¯’è½¯ä»¶
    echo 4. é‡æ–°æ¿€æ´»è™šæ‹ŸçŽ¯å¢ƒ: conda activate word
    echo 5. é‡æ–°è¿è¡Œæž„å»ºè„šæœ¬
    echo.
)

echo æŒ‰ä»»æ„é”®é€€å‡º...
pause >nul
