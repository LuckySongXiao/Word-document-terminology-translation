# 自动跳过已翻译内容功能说明

## 功能概述

本系统新增了**自动检测并跳过已翻译内容**的功能，能够智能识别文档中已经完成翻译的区域，避免重复翻译，提高翻译效率和质量。

## 主要特性

### 🎯 智能检测能力

1. **双语格式标记检测**
   - 【原文】...【译文】格式
   - 【中文】...【英文】格式  
   - 原文：...译文：格式
   - 中文：...英文：格式

2. **括号对照格式检测**
   - 中文(English)格式
   - English(中文)格式

3. **分行对照格式检测**
   - 中文行后跟英文行
   - 英文行后跟中文行
   - 交替语言模式

4. **非文本内容检测**
   - 纯数字（123、45.67）
   - 百分比（45.67%、100％）
   - 代码标识符（ABC123、API_KEY）
   - URL链接（https://example.com）
   - 邮箱地址（user@example.com）
   - 日期格式（2023-12-25）
   - 时间格式（14:30:00）

### 🌍 多语言支持

支持以下语言对的检测：
- 中文 ↔ 英文
- 中文 ↔ 日文
- 中文 ↔ 韩文
- 中文 ↔ 阿拉伯文
- 中文 ↔ 俄文
- 中文 ↔ 法文
- 中文 ↔ 德文
- 中文 ↔ 西班牙文

### 📄 全格式支持

该功能已集成到所有文档处理器中：
- **Word文档** (.docx) - 段落级检测
- **PDF文档** (.pdf) - 段落级检测
- **Excel表格** (.xlsx) - 单元格级检测
- **PowerPoint演示文稿** (.pptx) - 文本框和表格单元格级检测
- **纯文本文件** (.txt) - 段落级检测
- **Word旧格式** (.doc) - 段落级检测

## 使用方法

### 1. Web界面操作

1. 打开翻译系统Web界面
2. 在翻译选项中找到**"跳过已翻译内容"**复选框
3. 默认情况下该选项已启用（推荐保持启用）
4. 如需关闭该功能，取消勾选即可
5. 上传文档并开始翻译

### 2. 功能效果

启用该功能后，系统会：
- 自动扫描文档内容
- 识别已翻译的区域
- 在日志中显示跳过的内容和原因
- 只翻译未翻译的部分
- 保持已翻译内容不变

### 3. 日志示例

```
[INFO] 跳过翻译内容: 检测到双语格式标记 - 产品名称(Product Name)...
[INFO] 跳过翻译内容: 检测到中英文分行结构 - 这是中文内容\nThis is English...
[INFO] 跳过翻译内容: 纯数字/代码内容 - 123...
```

## 技术实现

### 核心组件

1. **TranslationDetector类** (`services/translation_detector.py`)
   - 主要的检测逻辑实现
   - 支持多种检测模式
   - 可配置的检测规则

2. **文档处理器集成**
   - 所有处理器都集成了检测功能
   - 在翻译前进行内容检测
   - 支持启用/禁用控制

3. **Web界面控制**
   - 用户友好的开关控制
   - 实时日志反馈
   - 翻译进度显示

### 检测算法

1. **文本预处理**
   - 清理空白字符
   - 标准化格式

2. **模式匹配**
   - 正则表达式匹配
   - 语言特征检测
   - 结构模式识别

3. **智能判断**
   - 多重检测条件
   - 上下文分析
   - 置信度评估

## 配置选项

### 默认设置
- 跳过已翻译内容：**启用**
- 检测敏感度：**标准**
- 日志记录：**启用**

### 自定义配置
可以通过修改 `TranslationDetector` 类来调整：
- 检测模式的优先级
- 正则表达式规则
- 语言支持范围
- 跳过条件阈值

## 注意事项

### ✅ 建议使用场景
- 部分翻译的文档
- 包含双语对照的文档
- 混合内容的文档
- 需要增量翻译的文档

### ⚠️ 注意事项
- 对于完全未翻译的文档，该功能不会影响翻译效果
- 复杂的混合格式可能需要人工检查
- 建议在重要文档翻译前先测试该功能

### 🔧 故障排除
- 如果检测过于敏感，可以关闭该功能
- 查看系统日志了解跳过的具体原因
- 对于特殊格式，可能需要调整检测规则

## 更新日志

### v3.0 新增功能
- ✨ 新增自动跳过已翻译内容功能
- 🎯 支持多种双语格式检测
- 🌍 支持多语言对检测
- 📄 全文档格式支持
- 🔧 用户友好的控制界面
- 📊 详细的日志反馈

---

**提示**: 该功能基于模式匹配和语言特征检测，在大多数情况下能够准确识别已翻译内容。如遇到特殊情况，可以关闭该功能或联系技术支持。
