# 多格式文档翻译助手 - 启动流程和使用指南

## 版本概览

本软件提供三个版本，满足不同使用场景：

### 1. Python版PC端
- **特点**: 功能完整，配置灵活
- **适用**: 个人用户，需要完整功能
- **启动**: `python main.py` 或双击exe文件

### 2. Python版WEB端
- **特点**: 浏览器访问，支持局域网共享
- **适用**: 多用户共享，远程访问
- **启动**: `python launcher.py` 或 `python web_server.py`

### 3. C#版PC端
- **特点**: 原生Windows应用，性能优秀
- **适用**: Windows用户，追求性能
- **启动**: 双击 `DocumentTranslator.exe`

## 快速启动指南

### 方式一：使用已打包版本（推荐新手）

#### Python版启动
1. 下载 `多格式文档翻译助手_调试版_v3.1.exe`
2. 双击运行
3. 选择启动模式：
   - **PC端模式**: 直接启动桌面应用
   - **WEB端模式**: 启动Web服务器并打开浏览器

#### C#版启动
1. 下载 `DocumentTranslator.exe`
2. 双击运行
3. 等待程序初始化完成

### 方式二：源码运行（推荐开发者）

#### 环境准备
```bash
# 安装Python依赖
pip install -r requirements.txt

# 安装.NET SDK（C#版本需要）
# 下载并安装 .NET 6.0 SDK
```

#### Python版启动
```bash
# PC端启动
python main.py

# WEB端启动（推荐）
python launcher.py

# 直接启动Web服务器
python web_server.py --host 0.0.0.0 --port 8000
```

#### C#版启动
```bash
# 编译并运行
dotnet run

# 或者编译后运行
dotnet build --configuration Release
cd bin/Release/net6.0
DocumentTranslator.exe
```

## 详细启动流程

### Python版PC端启动流程

1. **环境检查**
   - 检查Python版本（需要3.8+）
   - 验证依赖包是否完整
   - 初始化日志系统

2. **授权验证**
   - 检查授权文件是否存在
   - 验证授权码有效性
   - 显示授权信息

3. **服务初始化**
   - 初始化翻译服务
   - 加载术语库
   - 配置AI引擎

4. **界面启动**
   - 创建主窗口
   - 加载用户配置
   - 显示就绪状态

### Python版WEB端启动流程

1. **启动器模式**（推荐）
   ```bash
   python launcher.py
   ```
   - 自动检测端口可用性
   - 启动Web服务器
   - 自动打开浏览器
   - 显示访问地址

2. **直接启动模式**
   ```bash
   python web_server.py
   ```
   - 手动指定端口和主机
   - 需要手动打开浏览器
   - 适合服务器部署

3. **服务器初始化过程**
   - 加载翻译服务
   - 初始化术语库
   - 启动FastAPI应用
   - 绑定端口并监听

### C#版PC端启动流程

1. **程序启动**
   - 检查.NET运行时
   - 初始化依赖注入容器
   - 配置日志服务

2. **服务初始化**
   - 创建翻译服务实例
   - 初始化文档处理器
   - 加载配置管理器

3. **界面初始化**
   - 创建WPF主窗口
   - 绑定数据上下文
   - 加载用户界面

4. **Python桥接**
   - 检查Python环境
   - 初始化Python脚本桥接
   - 验证脚本可用性

## 首次使用配置

### 1. 授权激活（Python版）
1. 启动程序后会提示授权验证
2. 联系软件供应商获取授权码
3. 在授权对话框中输入授权码
4. 点击"验证授权"完成激活

### 2. AI引擎配置

#### 智谱AI配置
1. 注册智谱AI账号：https://open.bigmodel.cn/
2. 获取API Key
3. 在程序中配置：
   - 设置 → 智谱API设置
   - 输入API Key
   - 选择模型（推荐：glm-4-flash-250414）
   - 测试连接

#### Ollama配置（本地部署）
1. 下载安装Ollama：https://ollama.ai/
2. 启动Ollama服务：
   ```bash
   ollama serve
   ```
3. 下载模型：
   ```bash
   ollama pull qwen2:7b
   ```
4. 在程序中配置：
   - 设置API地址：http://localhost:11434
   - 选择已下载的模型

#### 硅基流动配置
1. 注册硅基流动账号：https://siliconflow.cn/
2. 获取API Key
3. 在程序中配置：
   - 设置 → 硅基流动设置
   - 输入API Key
   - 选择模型（推荐：deepseek-ai/DeepSeek-V2.5）

#### 内网OpenAI配置
1. 确保内网OpenAI服务可访问
2. 获取API地址和模型信息
3. 在程序中配置：
   - 设置 → 内网OpenAI设置
   - 输入API地址
   - 选择模型
   - 测试连接

### 3. 术语库初始化
1. 打开术语库编辑器
2. 选择目标语言
3. 添加常用专业术语
4. 保存术语库

## 常用启动命令

### Python版命令行参数
```bash
# PC端启动
python main.py

# WEB端启动（自动模式）
python launcher.py

# WEB端启动（手动模式）
python web_server.py --host 0.0.0.0 --port 8000

# 激活授权（管理员模式）
python main.py --activate-license
```

### C#版命令行参数
```bash
# 标准启动
DocumentTranslator.exe

# 指定配置文件
DocumentTranslator.exe --config config.json

# 调试模式
DocumentTranslator.exe --debug
```

## 网络部署

### 局域网WEB服务部署
1. **服务器端**：
   ```bash
   python launcher.py
   ```
   - 记录显示的IP地址和端口
   - 确保防火墙允许访问

2. **客户端访问**：
   - 浏览器访问：http://[服务器IP]:8000
   - 例如：http://192.168.1.100:8000

### 内网服务器部署
1. **环境准备**：
   - 安装Python 3.8+
   - 安装依赖包
   - 配置防火墙

2. **服务启动**：
   ```bash
   # 后台运行
   nohup python web_server.py --host 0.0.0.0 --port 8000 &
   
   # 或使用systemd服务
   sudo systemctl start document-translator
   ```

## 故障排除

### 启动失败
1. **检查环境**：
   - Python版本是否正确
   - 依赖包是否完整
   - .NET运行时是否安装

2. **检查权限**：
   - 确保有足够的文件读写权限
   - 检查防火墙设置

3. **检查端口**：
   - 确认端口未被占用
   - 尝试使用其他端口

### 服务异常
1. **查看日志**：
   - 检查程序日志文件
   - 查看控制台错误信息

2. **重启服务**：
   - 完全关闭程序
   - 重新启动

3. **重置配置**：
   - 删除配置文件
   - 重新配置

## 性能优化

### 硬件要求
- **CPU**: 双核以上
- **内存**: 4GB以上（推荐8GB）
- **存储**: SSD硬盘
- **网络**: 稳定的网络连接

### 软件优化
- 定期清理临时文件
- 优化术语库大小
- 选择合适的AI引擎
- 合理设置并发数量

## 版本选择建议

### 选择Python版PC端，如果：
- 需要完整的功能
- 喜欢灵活的配置
- 熟悉Python环境

### 选择Python版WEB端，如果：
- 需要多用户共享
- 要求跨平台访问
- 部署在服务器上

### 选择C#版PC端，如果：
- 主要在Windows上使用
- 追求更好的性能
- 喜欢原生应用体验

---

*本指南适用于多格式文档翻译助手 v3.1 所有版本*
