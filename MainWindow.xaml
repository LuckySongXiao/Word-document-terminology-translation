<Window x:Class="DocumentTranslator.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="å¤šæ ¼å¼æ–‡æ¡£ç¿»è¯‘åŠ©æ‰‹ v3.1" 
        Height="800" Width="1200"
        MinHeight="600" MinWidth="900"
        WindowStartupLocation="CenterScreen"
        Icon="logo.ico">
    
    <Window.Resources>
        <!-- æ ·å¼å®šä¹‰ -->
        <Style x:Key="CardStyle" TargetType="Border">
            <Setter Property="Background" Value="#F8F9FA"/>
            <Setter Property="BorderBrush" Value="#E9ECEF"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Padding" Value="15"/>
        </Style>
        
        <Style x:Key="HeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#2C3E50"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
        </Style>
        
        <Style x:Key="StatusStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- èœå•æ  -->
        <Menu Grid.Row="0">
            <MenuItem Header="è®¾ç½®(_S)">
                <MenuItem Header="æ™ºè°±AIè®¾ç½®" Click="OpenZhipuSettings"/>
                <MenuItem Header="Ollamaè®¾ç½®" Click="OpenOllamaSettings"/>
                <MenuItem Header="ç¡…åŸºæµåŠ¨è®¾ç½®" Click="OpenSiliconFlowSettings"/>
                <MenuItem Header="å†…ç½‘OpenAIè®¾ç½®" Click="OpenIntranetSettings"/>
            </MenuItem>
            <MenuItem Header="å¸®åŠ©(_H)">
                <MenuItem Header="æŽˆæƒä¿¡æ¯" Click="ShowLicenseInfo"/>
                <MenuItem Header="å…³äºŽ" Click="ShowAbout"/>
            </MenuItem>
        </Menu>
        
        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <Grid Grid.Row="1" Margin="10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="400"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <!-- å·¦ä¾§æŽ§åˆ¶é¢æ¿ -->
            <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto">
                <StackPanel>
                    
                    <!-- ç³»ç»ŸçŠ¶æ€å¡ç‰‡ -->
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <TextBlock Text="ðŸ“Š ç³»ç»ŸçŠ¶æ€" Style="{StaticResource HeaderStyle}"/>
                            <TextBlock x:Name="StatusText" Text="ðŸŸ¢ ç³»ç»Ÿå°±ç»ª" Style="{StaticResource StatusStyle}" Foreground="Green"/>
                            <ProgressBar x:Name="TranslationProgress" Height="20" Margin="0,10,0,0" Visibility="Collapsed"/>
                            <TextBlock x:Name="ProgressText" Style="{StaticResource StatusStyle}" Visibility="Collapsed"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- æ–‡æ¡£ç®¡ç†å¡ç‰‡ -->
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <TextBlock Text="ðŸ“ æ–‡æ¡£ç®¡ç†" Style="{StaticResource HeaderStyle}"/>
                            <TextBox x:Name="FilePathText" IsReadOnly="True" Margin="0,5" Height="25"/>
                            <StackPanel Orientation="Horizontal" Margin="0,5">
                                <Button Content="ðŸ” é€‰æ‹©æ–‡ä»¶" Click="SelectFile" Width="100" Margin="0,0,5,0"/>
                                <Button Content="ðŸ—‘ï¸ æ¸…é™¤" Click="ClearFile" Width="80"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                    
                    <!-- ç¿»è¯‘é…ç½®å¡ç‰‡ -->
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <TextBlock Text="ðŸŒ ç¿»è¯‘é…ç½®" Style="{StaticResource HeaderStyle}"/>
                            
                            <!-- ç¿»è¯‘æ–¹å‘ -->
                            <TextBlock Text="ðŸ”„ ç¿»è¯‘æ–¹å‘" FontWeight="Bold" Margin="0,5"/>
                            <RadioButton x:Name="ChineseToForeign" Content="ðŸ‡¨ðŸ‡³ ä¸­æ–‡ â†’ å¤–è¯­" IsChecked="True" Margin="0,2"/>
                            <RadioButton x:Name="ForeignToChinese" Content="ðŸŒ å¤–è¯­ â†’ ä¸­æ–‡" Margin="0,2"/>
                            
                            <!-- ç›®æ ‡è¯­è¨€ -->
                            <TextBlock Text="ðŸ—£ï¸ ç›®æ ‡è¯­è¨€" FontWeight="Bold" Margin="0,10,0,5"/>
                            <ComboBox x:Name="LanguageCombo" Height="25" SelectedIndex="0">
                                <ComboBoxItem Content="è‹±è¯­"/>
                                <ComboBoxItem Content="æ—¥è¯­"/>
                                <ComboBoxItem Content="éŸ©è¯­"/>
                                <ComboBoxItem Content="æ³•è¯­"/>
                                <ComboBoxItem Content="å¾·è¯­"/>
                                <ComboBoxItem Content="è¥¿ç­ç‰™è¯­"/>
                                <ComboBoxItem Content="æ„å¤§åˆ©è¯­"/>
                                <ComboBoxItem Content="ä¿„è¯­"/>
                            </ComboBox>
                        </StackPanel>
                    </Border>
                    
                    <!-- AIç¿»è¯‘å¼•æ“Žå¡ç‰‡ -->
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <TextBlock Text="ðŸ¤– AIç¿»è¯‘å¼•æ“Ž" Style="{StaticResource HeaderStyle}"/>
                            
                            <!-- å¼•æ“Žé€‰æ‹© -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <Button x:Name="ZhipuButton" Grid.Row="0" Grid.Column="0" Content="ðŸ§  æ™ºè°±AI" 
                                        Click="SelectZhipuAI" Margin="2" Height="35"/>
                                <Button x:Name="OllamaButton" Grid.Row="0" Grid.Column="1" Content="ðŸ¦™ Ollama" 
                                        Click="SelectOllama" Margin="2" Height="35"/>
                                <Button x:Name="SiliconFlowButton" Grid.Row="1" Grid.Column="0" Content="ðŸ’Ž ç¡…åŸºæµåŠ¨" 
                                        Click="SelectSiliconFlow" Margin="2" Height="35"/>
                                <Button x:Name="IntranetButton" Grid.Row="1" Grid.Column="1" Content="ðŸŒ å†…ç½‘OpenAI" 
                                        Click="SelectIntranet" Margin="2" Height="35"/>
                            </Grid>
                            
                            <!-- æ¨¡åž‹é€‰æ‹© -->
                            <TextBlock Text="ðŸŽ¯ æ¨¡åž‹é€‰æ‹©" FontWeight="Bold" Margin="0,10,0,5"/>
                            <ComboBox x:Name="ModelCombo" Height="25"/>
                            <Button Content="ðŸ”„ åˆ·æ–°æ¨¡åž‹" Click="RefreshModels" Margin="0,5" Height="25"/>
                            
                            <!-- è¿žæŽ¥æµ‹è¯• -->
                            <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                <Button Content="ðŸ§ª æµ‹è¯•è¿žæŽ¥" Click="TestConnection" Width="100"/>
                                <TextBlock x:Name="TestStatusText" Text="ðŸ” æœªæµ‹è¯•" Style="{StaticResource StatusStyle}" Margin="10,0"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                    
                    <!-- ç¿»è¯‘é€‰é¡¹å¡ç‰‡ -->
                    <Border Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <TextBlock Text="âš™ï¸ ç¿»è¯‘é€‰é¡¹" Style="{StaticResource HeaderStyle}"/>
                            <CheckBox x:Name="UseTerminology" Content="âœ… ä½¿ç”¨æœ¯è¯­åº“è¿›è¡Œç¿»è¯‘" IsChecked="True" Margin="0,2"/>
                            <CheckBox x:Name="PreprocessTerms" Content="âš¡ ä½¿ç”¨æœ¯è¯­é¢„å¤„ç†" IsChecked="True" Margin="0,2"/>
                            <CheckBox x:Name="ExportPDF" Content="ðŸ“‘ åŒæ—¶å¯¼å‡ºPDFæ–‡ä»¶" Margin="0,2"/>

                            <!-- è¾“å‡ºæ ¼å¼é€‰é¡¹ -->
                            <TextBlock Text="ðŸ“‹ è¾“å‡ºæ ¼å¼" FontWeight="Bold" Margin="0,10,0,5"/>
                            <RadioButton x:Name="BilingualOutput" Content="ðŸ“‹ åŒè¯­å¯¹ç…§æ˜¾ç¤º" IsChecked="True" Margin="0,2"/>
                            <RadioButton x:Name="TranslationOnlyOutput" Content="ðŸ“ ä»…æ˜¾ç¤ºç¿»è¯‘ç»“æžœ" Margin="0,2"/>
                            <TextBlock Text="ðŸ’¡ åŒè¯­å¯¹ç…§ä¾¿äºŽå¯¹æ¯”ï¼Œä»…ç¿»è¯‘ç»“æžœæ›´ç®€æ´"
                                       FontSize="10" Foreground="Gray" Margin="0,2,0,10" TextWrapping="Wrap"/>

                            <Button Content="ðŸ“ æ‰“å¼€æœ¯è¯­åº“ç¼–è¾‘å™¨" Click="OpenTerminologyEditor" Margin="0,5,0,0" Height="30"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- å¼€å§‹ç¿»è¯‘å¡ç‰‡ -->
                    <Border Style="{StaticResource CardStyle}" Background="#FFEBEE">
                        <StackPanel>
                            <TextBlock Text="ðŸš€ å¼€å§‹ç¿»è¯‘" Style="{StaticResource HeaderStyle}"/>
                            <Button x:Name="TranslateButton" Content="ðŸš€ å¼€å§‹ç¿»è¯‘" Click="StartTranslation" 
                                    Height="40" FontSize="14" FontWeight="Bold" Background="#4CAF50" Foreground="White"/>
                            <TextBlock Text="ðŸ’¡ è¯·ç¡®ä¿å·²é€‰æ‹©æ–‡ä»¶ã€è®¾ç½®ç¿»è¯‘æ–¹å‘å’Œæ£€æŸ¥ç¿»è¯‘å™¨çŠ¶æ€" 
                                       Style="{StaticResource StatusStyle}" Foreground="Gray" TextWrapping="Wrap" Margin="0,5"/>
                        </StackPanel>
                    </Border>
                    
                </StackPanel>
            </ScrollViewer>
            
            <!-- å³ä¾§æ—¥å¿—é¢æ¿ -->
            <Border Grid.Column="1" Style="{StaticResource CardStyle}" Margin="10,0,0,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Text="ðŸ“‹ å®žæ—¶æ—¥å¿—" Style="{StaticResource HeaderStyle}"/>
                    
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <TextBox x:Name="LogTextBox" IsReadOnly="True" TextWrapping="Wrap" 
                                 Background="Black" Foreground="LightGreen" FontFamily="Consolas" FontSize="11"
                                 VerticalScrollBarVisibility="Auto"/>
                    </ScrollViewer>
                    
                    <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,5,0,0">
                        <Button Content="ðŸ“ æ‰“å¼€è¾“å‡ºç›®å½•" Click="OpenOutputDirectory" Width="120" Height="30" Margin="0,0,5,0"/>
                        <Button Content="ðŸ“‹ å¤åˆ¶æ—¥å¿—" Click="CopyLog" Width="90" Height="30" Margin="0,0,5,0"/>
                        <Button Content="ðŸ’¾ ä¿å­˜æ—¥å¿—" Click="SaveLog" Width="90" Height="30" Margin="0,0,5,0"/>
                        <Button Content="ðŸ—‘ï¸ æ¸…é™¤æ—¥å¿—" Click="ClearLog" Width="90" Height="30"/>
                    </StackPanel>
                </Grid>
            </Border>
            
        </Grid>
        
        <!-- çŠ¶æ€æ  -->
        <StatusBar Grid.Row="2">
            <StatusBarItem>
                <TextBlock x:Name="StatusBarText" Text="å°±ç»ª"/>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock Text="å¤šæ ¼å¼æ–‡æ¡£ç¿»è¯‘åŠ©æ‰‹ v3.1"/>
            </StatusBarItem>
        </StatusBar>
        
    </Grid>
</Window>
