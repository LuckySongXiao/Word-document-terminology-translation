<Window x:Class="DocumentTranslator.Windows.EngineConfigWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="AIå¼•æ“Žé…ç½®" Height="500" Width="600"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize">
    
    <Window.Resources>
        <Style x:Key="ConfigCardStyle" TargetType="Border">
            <Setter Property="Background" Value="#F8F9FA"/>
            <Setter Property="BorderBrush" Value="#E9ECEF"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Margin" Value="10"/>
            <Setter Property="Padding" Value="15"/>
        </Style>
        
        <Style x:Key="ConfigHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#2C3E50"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- æ ‡é¢˜æ  -->
        <Border Grid.Row="0" Background="#3498DB" Padding="15">
            <TextBlock Text="ðŸ¤– AIå¼•æ“Žé…ç½®ç®¡ç†" FontSize="18" FontWeight="Bold" Foreground="White"/>
        </Border>
        
        <!-- é…ç½®é€‰é¡¹å¡ -->
        <TabControl Grid.Row="1" Margin="10">
            
            <!-- æ™ºè°±AIé…ç½® -->
            <TabItem Header="ðŸ§  æ™ºè°±AI">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <Border Style="{StaticResource ConfigCardStyle}">
                        <StackPanel>
                            <TextBlock Text="æ™ºè°±AIé…ç½®" Style="{StaticResource ConfigHeaderStyle}"/>
                            
                            <TextBlock Text="APIå¯†é’¥" FontWeight="Bold" Margin="0,5"/>
                            <PasswordBox x:Name="ZhipuApiKey" Height="35" Margin="0,2,0,10"/>

                            <TextBlock Text="APIåœ°å€" FontWeight="Bold" Margin="0,5"/>
                            <TextBox x:Name="ZhipuApiUrl" Text="https://open.bigmodel.cn/api/paas/v4/chat/completions"
                                     Height="35" Margin="0,2,0,10" TextWrapping="Wrap"/>

                            <TextBlock Text="é»˜è®¤æ¨¡åž‹" FontWeight="Bold" Margin="0,5"/>
                            <ComboBox x:Name="ZhipuDefaultModel" Height="35" Margin="0,2,0,10">
                                <ComboBoxItem Content="GLM-4-Flash-250414" IsSelected="True"/>
                                <ComboBoxItem Content="GLM-4.1V-Thinking-Flash"/>
                                <ComboBoxItem Content="GLM-4V-Flash"/>
                                <ComboBoxItem Content="GLM-Z1-Flash"/>
                            </ComboBox>

                            <TextBlock Text="æ¸©åº¦å‚æ•° (0.0-1.0)" FontWeight="Bold" Margin="0,5"/>
                            <Slider x:Name="ZhipuTemperature" Minimum="0" Maximum="1" Value="0.3"
                                    TickFrequency="0.1" IsSnapToTickEnabled="True" Margin="0,2,0,5"/>
                            <TextBlock Text="{Binding ElementName=ZhipuTemperature, Path=Value, StringFormat=F1}"
                                       HorizontalAlignment="Center" Margin="0,0,0,10"/>

                            <TextBlock Text="æœ€å¤§ä»¤ç‰Œæ•°" FontWeight="Bold" Margin="0,5"/>
                            <TextBox x:Name="ZhipuMaxTokens" Text="4000" Height="35" Margin="0,2,0,10"/>
                            
                            <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                <Button Content="ðŸ§ª æµ‹è¯•è¿žæŽ¥" Click="TestZhipuConnection" Width="100" Margin="0,0,10,0"/>
                                <Button Content="ðŸ’¾ ä¿å­˜é…ç½®" Click="SaveZhipuConfig" Width="100"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </ScrollViewer>
            </TabItem>
            
            <!-- Ollamaé…ç½® -->
            <TabItem Header="ðŸ¦™ Ollama">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <Border Style="{StaticResource ConfigCardStyle}">
                        <StackPanel>
                            <TextBlock Text="Ollamaé…ç½®" Style="{StaticResource ConfigHeaderStyle}"/>
                            
                            <TextBlock Text="æœåŠ¡åœ°å€" FontWeight="Bold" Margin="0,5"/>
                            <TextBox x:Name="OllamaUrl" Text="http://localhost:11434" Height="35" Margin="0,2,0,10"/>

                            <TextBlock Text="é»˜è®¤æ¨¡åž‹" FontWeight="Bold" Margin="0,5"/>
                            <ComboBox x:Name="OllamaDefaultModel" Height="35" Margin="0,2,0,10" IsEditable="True">
                                <ComboBoxItem Content="llama2"/>
                                <ComboBoxItem Content="qwen"/>
                                <ComboBoxItem Content="mistral"/>
                                <ComboBoxItem Content="codellama"/>
                            </ComboBox>

                            <TextBlock Text="æ¸©åº¦å‚æ•° (0.0-1.0)" FontWeight="Bold" Margin="0,5"/>
                            <Slider x:Name="OllamaTemperature" Minimum="0" Maximum="1" Value="0.3"
                                    TickFrequency="0.1" IsSnapToTickEnabled="True" Margin="0,2,0,5"/>
                            <TextBlock Text="{Binding ElementName=OllamaTemperature, Path=Value, StringFormat=F1}"
                                       HorizontalAlignment="Center" Margin="0,0,0,10"/>

                            <TextBlock Text="ä¸Šä¸‹æ–‡é•¿åº¦" FontWeight="Bold" Margin="0,5"/>
                            <TextBox x:Name="OllamaContextLength" Text="4096" Height="35" Margin="0,2,0,10"/>
                            
                            <CheckBox x:Name="OllamaKeepAlive" Content="ä¿æŒæ¨¡åž‹åŠ è½½" Margin="0,5"/>
                            
                            <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                <Button Content="ðŸ”„ åˆ·æ–°æ¨¡åž‹" Click="RefreshOllamaModels" Width="100" Margin="0,0,10,0"/>
                                <Button Content="ðŸ§ª æµ‹è¯•è¿žæŽ¥" Click="TestOllamaConnection" Width="100" Margin="0,0,10,0"/>
                                <Button Content="ðŸ’¾ ä¿å­˜é…ç½®" Click="SaveOllamaConfig" Width="100"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </ScrollViewer>
            </TabItem>
            
            <!-- ç¡…åŸºæµåŠ¨é…ç½® -->
            <TabItem Header="ðŸ’Ž ç¡…åŸºæµåŠ¨">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <Border Style="{StaticResource ConfigCardStyle}">
                        <StackPanel>
                            <TextBlock Text="ç¡…åŸºæµåŠ¨é…ç½®" Style="{StaticResource ConfigHeaderStyle}"/>
                            
                            <TextBlock Text="APIå¯†é’¥" FontWeight="Bold" Margin="0,5"/>
                            <PasswordBox x:Name="SiliconFlowApiKey" Height="35" Margin="0,2,0,10"/>

                            <TextBlock Text="APIåœ°å€" FontWeight="Bold" Margin="0,5"/>
                            <TextBox x:Name="SiliconFlowApiUrl" Text="https://api.siliconflow.cn/v1/chat/completions"
                                     Height="35" Margin="0,2,0,10" TextWrapping="Wrap"/>

                            <TextBlock Text="é»˜è®¤æ¨¡åž‹" FontWeight="Bold" Margin="0,5"/>
                            <ComboBox x:Name="SiliconFlowDefaultModel" Height="35" Margin="0,2,0,10">
                                <ComboBoxItem Content="deepseek-ai/DeepSeek-V2.5"/>
                                <ComboBoxItem Content="Qwen/Qwen2.5-72B-Instruct"/>
                                <ComboBoxItem Content="meta-llama/Meta-Llama-3.1-70B-Instruct"/>
                                <ComboBoxItem Content="01-ai/Yi-1.5-34B-Chat"/>
                            </ComboBox>

                            <TextBlock Text="æ¸©åº¦å‚æ•° (0.0-1.0)" FontWeight="Bold" Margin="0,5"/>
                            <Slider x:Name="SiliconFlowTemperature" Minimum="0" Maximum="1" Value="0.3"
                                    TickFrequency="0.1" IsSnapToTickEnabled="True" Margin="0,2,0,5"/>
                            <TextBlock Text="{Binding ElementName=SiliconFlowTemperature, Path=Value, StringFormat=F1}"
                                       HorizontalAlignment="Center" Margin="0,0,0,10"/>

                            <TextBlock Text="æœ€å¤§ä»¤ç‰Œæ•°" FontWeight="Bold" Margin="0,5"/>
                            <TextBox x:Name="SiliconFlowMaxTokens" Text="4000" Height="35" Margin="0,2,0,10"/>
                            
                            <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                <Button Content="ðŸ§ª æµ‹è¯•è¿žæŽ¥" Click="TestSiliconFlowConnection" Width="100" Margin="0,0,10,0"/>
                                <Button Content="ðŸ’¾ ä¿å­˜é…ç½®" Click="SaveSiliconFlowConfig" Width="100"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </ScrollViewer>
            </TabItem>
            
            <!-- å†…ç½‘OpenAIé…ç½® -->
            <TabItem Header="ðŸŒ å†…ç½‘OpenAI">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <Border Style="{StaticResource ConfigCardStyle}">
                        <StackPanel>
                            <TextBlock Text="å†…ç½‘OpenAIé…ç½®" Style="{StaticResource ConfigHeaderStyle}"/>
                            
                            <TextBlock Text="APIå¯†é’¥" FontWeight="Bold" Margin="0,5"/>
                            <PasswordBox x:Name="IntranetApiKey" Height="35" Margin="0,2,0,10"/>

                            <TextBlock Text="APIåœ°å€" FontWeight="Bold" Margin="0,5"/>
                            <TextBox x:Name="IntranetApiUrl" Text="http://your-internal-server/v1/chat/completions"
                                     Height="35" Margin="0,2,0,10" TextWrapping="Wrap"/>

                            <TextBlock Text="é»˜è®¤æ¨¡åž‹" FontWeight="Bold" Margin="0,5"/>
                            <ComboBox x:Name="IntranetDefaultModel" Height="35" Margin="0,2,0,10" IsEditable="True">
                                <ComboBoxItem Content="deepseek-r1-70b"/>
                                <ComboBoxItem Content="gpt-4"/>
                                <ComboBoxItem Content="gpt-3.5-turbo"/>
                                <ComboBoxItem Content="claude-3"/>
                            </ComboBox>

                            <TextBlock Text="æ¸©åº¦å‚æ•° (0.0-1.0)" FontWeight="Bold" Margin="0,5"/>
                            <Slider x:Name="IntranetTemperature" Minimum="0" Maximum="1" Value="0.3"
                                    TickFrequency="0.1" IsSnapToTickEnabled="True" Margin="0,2,0,5"/>
                            <TextBlock Text="{Binding ElementName=IntranetTemperature, Path=Value, StringFormat=F1}"
                                       HorizontalAlignment="Center" Margin="0,0,0,10"/>

                            <TextBlock Text="æœ€å¤§ä»¤ç‰Œæ•°" FontWeight="Bold" Margin="0,5"/>
                            <TextBox x:Name="IntranetMaxTokens" Text="4000" Height="35" Margin="0,2,0,10"/>
                            
                            <CheckBox x:Name="IntranetSkipSSL" Content="è·³è¿‡SSLéªŒè¯" Margin="0,5"/>
                            
                            <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                <Button Content="ðŸ§ª æµ‹è¯•è¿žæŽ¥" Click="TestIntranetConnection" Width="100" Margin="0,0,10,0"/>
                                <Button Content="ðŸ’¾ ä¿å­˜é…ç½®" Click="SaveIntranetConfig" Width="100"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </ScrollViewer>
            </TabItem>
            
        </TabControl>
        
        <!-- åº•éƒ¨æŒ‰é’® -->
        <Border Grid.Row="2" Background="#ECF0F1" Padding="15">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="ðŸ“ æ‰“å¼€é…ç½®ç›®å½•" Click="OpenConfigDirectory" Width="120" Margin="0,0,10,0"/>
                <Button Content="ðŸ”„ é‡ç½®æ‰€æœ‰é…ç½®" Click="ResetAllConfigs" Width="120" Margin="0,0,10,0"/>
                <Button Content="âœ… ç¡®å®š" Click="CloseWindow" Width="80" IsDefault="True"/>
            </StackPanel>
        </Border>
        
    </Grid>
</Window>
