# 多格式文档翻译助手 - EXE封装方案

## 概述

本项目提供了完整的一键封装方案，可以将多格式文档翻译助手打包成独立的EXE可执行文件，支持在Windows系统上直接运行，无需安装Python环境。

## 封装特性

### ✅ 核心功能
- **一键启动**: 双击EXE文件即可运行
- **双模式支持**: 支持PC端UI和Web端UI两种界面
- **完整功能**: 包含所有翻译功能和术语库管理
- **局域网访问**: Web模式支持局域网内其他设备访问
- **自动依赖**: 内置所有必需的Python库和依赖

### ✅ 技术特性
- **单文件启动器**: 启动器为单个EXE文件，便于分发
- **智能检测**: 自动检测和启动相应的程序模块
- **错误处理**: 完善的错误提示和日志记录
- **资源嵌入**: 图标、配置文件等资源完全嵌入
- **兼容性**: 支持Windows 10/11系统

## 构建方法

### 方法一：使用批处理文件（推荐）

1. **运行构建脚本**
   ```bash
   双击运行 build.bat
   ```

2. **自动化流程**
   - 检查Python环境
   - 安装构建依赖
   - 执行打包过程
   - 生成EXE文件

### 方法二：手动构建

1. **安装依赖**
   ```bash
   pip install -r requirements_build.txt
   ```

2. **执行构建**
   ```bash
   python build.py
   ```

## 构建输出

### 文件结构
```
dist/
├── 多格式文档翻译助手-启动器.exe    # 主启动器（单文件）
└── 多格式文档翻译助手/              # 完整程序包（目录形式）
    ├── 多格式文档翻译助手.exe       # 主程序
    ├── _internal/                   # 内部依赖文件
    ├── data/                        # 数据文件
    ├── web/                         # Web界面文件
    └── ...                          # 其他资源文件
```

### 使用说明
- **启动器**: `多格式文档翻译助手-启动器.exe` 是单个文件，可直接运行
- **完整包**: `多格式文档翻译助手/` 目录包含完整功能，可整体复制到其他电脑

## 启动器功能

### 界面特性
- **现代化UI**: 美观的图形界面
- **双模式选择**: PC端UI / Web端UI
- **状态显示**: 实时显示启动状态和进度
- **错误处理**: 友好的错误提示信息
- **日志记录**: 详细的启动日志显示

### 启动流程
1. **PC端模式**: 启动传统桌面应用界面
2. **Web端模式**: 启动Web服务器并自动打开浏览器
3. **智能检测**: 自动检测端口占用和程序状态
4. **局域网提示**: 显示局域网访问地址

## 部署说明

### 系统要求
- **操作系统**: Windows 10/11 (64位)
- **内存**: 建议4GB以上
- **磁盘空间**: 至少500MB可用空间
- **网络**: Web模式需要网络连接（可选）

### 分发方式
1. **单文件分发**: 只需分发启动器EXE文件
2. **完整包分发**: 分发整个程序目录
3. **网络部署**: 在服务器上运行Web模式

### 首次运行
- 首次启动可能需要几秒钟时间
- Windows可能显示安全警告，选择"仍要运行"
- 杀毒软件可能误报，需要添加信任

## 技术细节

### 打包工具
- **PyInstaller**: 主要打包工具
- **自定义钩子**: 处理特殊依赖和资源
- **优化配置**: 减小文件大小和提高启动速度

### 依赖管理
- **核心库**: FastAPI、Uvicorn、Tkinter等
- **AI库**: OpenAI、智谱AI等翻译引擎
- **文档处理**: python-docx、PyMuPDF、openpyxl等
- **系统库**: pywin32、psutil等Windows特定库

### 资源嵌入
- **配置文件**: config.json、术语库等
- **Web资源**: HTML模板、CSS、JavaScript
- **图标文件**: 应用程序图标
- **数据文件**: 默认术语库和配置

## 故障排除

### 常见问题
1. **构建失败**: 检查Python版本和依赖安装
2. **启动失败**: 检查系统权限和杀毒软件
3. **功能异常**: 检查网络连接和端口占用
4. **性能问题**: 检查系统资源和磁盘空间

### 日志查看
- 启动器内置日志显示功能
- 详细错误信息会显示在界面上
- 可通过日志定位具体问题

## 更新说明

### 版本管理
- 每次构建会生成新的版本
- 保持向后兼容性
- 支持增量更新

### 配置迁移
- 自动检测旧版本配置
- 智能迁移用户数据
- 保留术语库和设置

---

**注意**: 本封装方案专为Windows系统设计，确保在目标系统上测试运行效果。
