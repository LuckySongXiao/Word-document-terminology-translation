# 多格式文档翻译助手 v3.1

一个支持多种文档格式的专业翻译工具，集成了多种AI翻译引擎，提供高质量的文档翻译服务。现已全面升级，提供三个版本以满足不同使用场景。

## 🚀 版本概览

### 🐍 Python版PC端（全功能版）
- **特点**: 功能最完整，配置最灵活，支持所有高级功能
- **界面**: 基于tkinter的现代化GUI界面
- **优势**:
  - ✅ 完整的术语库管理和编辑功能
  - ✅ 高级翻译质量检查和优化
  - ✅ 支持复杂文档结构处理
  - ✅ 多条目内容智能分段翻译
  - ✅ 实时翻译进度监控
- **适用**: 专业用户、需要完整功能的个人用户
- **启动**: `python main.py`

### 🌐 Python版WEB端（共享版）
- **特点**: 基于Web的现代化界面，支持局域网多用户访问
- **界面**: 响应式Web界面，支持移动端访问
- **优势**:
  - ✅ 无需安装客户端，浏览器即可使用
  - ✅ 支持局域网内多用户同时使用
  - ✅ 实时翻译状态推送
  - ✅ 文件上传下载管理
  - ✅ 跨平台兼容（Windows/Mac/Linux）
- **适用**: 团队协作、远程访问、多用户共享
- **启动**: `python launcher.py` 或 `python web_server.py`
- **访问**: 浏览器打开 `http://localhost:5000`

### 🖥️ C#版PC端（性能版）
- **特点**: 原生Windows应用，WPF界面，性能卓越
- **界面**: 现代化WPF界面，Windows原生体验
- **优势**:
  - ✅ 启动速度快，内存占用低
  - ✅ 原生Windows界面，操作流畅
  - ✅ 集成Python翻译引擎，性能优化
  - ✅ 支持拖拽操作，用户体验佳
  - ✅ 自包含部署，无需安装Python环境
- **适用**: Windows用户、追求性能和用户体验
- **启动**: `DocumentTranslator.exe`

## ✨ 主要特性

### 🔄 文档处理能力
- **多格式支持**: Word(.docx)、PDF、Excel(.xlsx)、PowerPoint(.pptx)、TXT等
- **智能结构保持**: 保持原文档格式、表格、图片等元素
- **批量处理**: 支持多文件同时翻译
- **复杂内容处理**: 智能识别和翻译多条目内容，避免遗漏

### 🌐 翻译引擎
- **多AI引擎**: 智谱AI、Ollama、硅基流动、内网OpenAI等
- **智能选择**: 根据内容类型自动选择最适合的引擎
- **质量优化**: 内置翻译质量检查和优化机制
- **术语一致性**: 专业术语库确保翻译一致性

### 🖥️ 多版本架构
- **Python PC端**: 功能最完整，支持所有高级特性
- **Python Web端**: 现代化Web界面，支持局域网共享
- **C# PC端**: 原生Windows应用，性能卓越
- **跨平台兼容**: Web版支持Windows/Mac/Linux

### 🔧 高级功能
- **实时监控**: 翻译进度和状态实时显示
- **术语库管理**: 可视化术语编辑和管理
- **授权管理**: 完善的授权验证和使用统计
- **局域网共享**: Web版支持多用户同时访问
- **智能分段**: 自动识别多条目内容并分段翻译

## 📋 系统要求

### 通用要求
- **操作系统**: Windows 10/11 (64位)
- **内存**: 建议 4GB 以上
- **网络**: 需要互联网连接（Ollama除外）

### Python版本
- **Python**: 3.8 或更高版本
- **依赖**: 见 requirements.txt

### C#版本
- **.NET**: 6.0 或更高版本（自包含部署无需安装）

## 🚀 快速启动

### 方式一：使用已打包版本（推荐新用户）

#### 🐍 Python版一键启动
1. 下载 `多格式文档翻译助手_调试版_v3.1.exe`
2. 双击运行，选择启动模式：
   - **PC端模式**: 启动桌面GUI应用
   - **Web端模式**: 启动Web服务器，浏览器访问

#### 🖥️ C#版原生应用
1. 下载 `DocumentTranslator.exe`
2. 双击运行（自包含，无需安装.NET环境）

### 方式二：源码运行（推荐开发者）

#### 环境准备
```bash
# 克隆项目
git clone [项目地址]
cd 文档术语翻译V3

# 创建虚拟环境（推荐）
python -m venv venv
venv\Scripts\activate  # Windows
source venv/bin/activate  # Linux/Mac

# 安装依赖
pip install -r requirements.txt
```

#### 启动选项
```bash
# 方式1: Python PC端（完整功能）
python main.py

# 方式2: Python Web端（推荐多用户）
python launcher.py
# 或直接启动Web服务器
python web_server.py

# 方式3: C#版编译运行
dotnet run
```

#### Web端访问
启动Web版后，在浏览器中访问：
- **本地访问**: http://localhost:5000
- **局域网访问**: http://[服务器IP]:5000

## 📖 详细使用说明

### 📚 版本专用指南
- [Python版PC端使用说明](Python版PC端使用说明.md) - 完整功能使用指南
- [Python版WEB端使用说明](Python版WEB端使用说明.md) - Web界面操作指南
- [C#版PC端使用说明](C#版PC端使用说明.md) - Windows原生应用指南

### 🔧 配置和部署
- [启动流程和使用指南](启动流程和使用指南.md) - 首次使用必读
- [内网环境解决方案](内网环境解决方案.md) - 企业内网部署指南
- [部署指南](部署指南.md) - 生产环境部署说明

### 🎯 版本选择建议
- **个人用户**: 推荐Python版PC端，功能最完整
- **团队协作**: 推荐Python版Web端，支持多用户
- **Windows用户**: 推荐C#版PC端，性能最佳
- **企业用户**: 推荐Web端+内网OpenAI，安全可控

## 📁 支持的文档格式

| 格式 | 扩展名 | 读取 | 写入 | 特殊功能 | 说明 |
|------|--------|------|------|----------|------|
| Word文档 | .docx | ✅ | ✅ | 表格智能处理 | 支持文本、表格、图片，保持格式 |
| PDF文档 | .pdf | ✅ | ✅ | 文本重排 | 支持文本提取和重新生成PDF |
| Excel表格 | .xlsx | ✅ | ✅ | 多工作表 | 支持复杂表格结构和公式 |
| PowerPoint | .pptx | ✅ | ✅ | 幻灯片布局 | 支持文本框、图表等元素 |
| 文本文件 | .txt | ✅ | ✅ | 编码检测 | 自动检测文件编码格式 |

### 🔧 高级处理能力
- **智能分段**: 自动识别多条目内容（如"1、...；2、..."）并分别翻译
- **格式保持**: 保持原文档的字体、颜色、布局等格式
- **表格处理**: 智能处理复杂表格结构，避免内容遗漏
- **术语一致性**: 基于术语库确保专业词汇翻译一致
- **质量检查**: 内置翻译质量检查，自动发现潜在问题

## 🌍 支持的翻译语言

- **源语言**: 中文（自动检测）
- **目标语言**: 英语、日语、韩语、法语、德语、西班牙语、意大利语、俄语

## 🤖 AI翻译引擎

### 1. 智谱AI
- **特点**: 高质量翻译，支持多种模型
- **配置**: 需要API Key
- **推荐模型**: glm-4-flash-250414
- **官网**: https://open.bigmodel.cn/

### 2. Ollama（本地部署）
- **特点**: 完全本地化，保护隐私
- **配置**: 需要本地安装Ollama服务
- **推荐模型**: qwen2:7b, llama3:8b
- **官网**: https://ollama.ai/

### 3. 硅基流动
- **特点**: 性价比高，响应速度快
- **配置**: 需要API Key
- **推荐模型**: deepseek-ai/DeepSeek-V2.5
- **官网**: https://siliconflow.cn/

### 4. 内网OpenAI
- **特点**: 支持企业内网部署
- **配置**: 需要内网API地址
- **兼容**: OpenAI API格式
- **适用**: 企业用户

## 🔧 首次使用配置

### 1. 授权激活（Python版）
1. 启动程序后输入授权码
2. 联系软件供应商获取授权
3. 完成激活验证

### 2. AI引擎配置
选择并配置至少一个AI引擎：
- 智谱AI：获取API Key并配置
- Ollama：本地安装并启动服务
- 硅基流动：获取API Key并配置
- 内网OpenAI：配置内网API地址

### 3. 术语库设置（可选）
- 添加专业术语对照
- 导入现有术语库
- 按语言分类管理

## 📊 项目结构

```
文档术语翻译V3/
├── � 启动文件
│   ├── main.py                    # Python版PC端入口（tkinter GUI）
│   ├── launcher.py                # 统一启动器（选择PC/Web模式）
│   ├── web_server.py             # Python版Web服务器
│   ├── DocumentTranslator.exe    # C#版PC端（WPF应用）
│   └── *.xaml / *.cs             # C#版界面和逻辑文件
├── � 核心模块
│   ├── services/                 # 翻译引擎和文档处理
│   │   ├── zhipuai_translator.py # 智谱AI翻译（已优化多条目处理）
│   │   ├── ollama_translator.py  # Ollama本地翻译
│   │   ├── siliconflow_translator.py # 硅基流动翻译
│   │   ├── document_processor.py # 文档处理核心
│   │   └── *.py                  # 其他处理模块
│   ├── ui/                      # Python PC端界面
│   │   ├── main_window.py        # 主窗口界面
│   │   ├── terminology_editor.py # 术语库编辑器
│   │   └── *.py                  # 其他界面组件
│   ├── web/                     # Web端相关
│   │   ├── api.py               # Web API接口
│   │   ├── templates/           # HTML模板
│   │   ├── static/              # 静态资源
│   │   └── realtime_logger.py   # 实时日志推送
│   └── utils/                   # 工具模块
│       ├── terminology.py       # 术语库管理
│       ├── api_config.py        # API配置管理
│       └── *.py                 # 其他工具
├── 📁 配置和数据
│   ├── API_config/              # AI引擎配置文件
│   │   ├── zhipu_api.json       # 智谱AI配置
│   │   ├── ollama_api.json      # Ollama配置
│   │   └── *.json               # 其他引擎配置
│   ├── data/                    # 数据文件
│   │   └── terminology.json     # 术语库（已扩充专业术语）
│   ├── config.json              # 主配置文件
│   └── license.dat              # 授权文件
├── 📁 输出目录
│   └── 输出/                    # 翻译结果文件
└── 📄 说明文档
    ├── Python版PC端使用说明.md
    ├── Python版WEB端使用说明.md
    ├── C#版PC端使用说明.md
    ├── 启动流程和使用指南.md
    ├── 内网环境解决方案.md
    └── 部署指南.md
```

## 🔧 开发说明

### 技术栈

#### 🐍 Python版本
- **后端框架**: FastAPI + uvicorn（Web版）
- **桌面GUI**: tkinter（PC版）
- **文档处理**: python-docx, PyPDF2, openpyxl, python-pptx
- **AI集成**: requests + 各厂商API
- **异步处理**: asyncio + threading

#### 🖥️ C#版本
- **桌面框架**: WPF + .NET 6.0
- **Python集成**: 进程调用Python脚本
- **界面设计**: XAML + MVVM模式
- **性能优化**: 异步编程 + 内存管理

#### 🌐 Web版本
- **前端**: HTML5 + JavaScript + Bootstrap 5
- **实时通信**: WebSocket（实时日志推送）
- **文件处理**: 拖拽上传 + 进度显示
- **响应式设计**: 支持移动端访问

### 开发环境
```bash
# 克隆项目
git clone https://github.com/LuckySongXiao/Word-document-terminology-translation.git

# 创建虚拟环境
python -m venv venv
source venv/bin/activate  # Linux/Mac
venv\Scripts\activate     # Windows

# 安装依赖
pip install -r requirements.txt

# 启动开发服务器
python launcher.py
```

## 🐛 常见问题

### 启动问题
- 检查Python版本和依赖包
- 确认端口未被占用
- 检查防火墙设置

### 翻译失败
- 验证AI引擎配置
- 检查网络连接
- 查看详细错误日志

### 文档处理问题
- 确认文档格式支持
- 检查文档是否损坏
- 尝试转换文档格式

## 📞 技术支持

- **版本**: v3.1
- **更新日期**: 2025年7月21日
- **技术支持**: 联系软件供应商
- **问题反馈**: 通过官方渠道提交

## 📝 更新日志

### v3.1 (2025-07-21) - 全面升级版
#### 🆕 新增功能
- ✨ **C#版PC端**: 全新WPF应用，原生Windows体验
- � **Web端升级**: 现代化响应式界面，支持移动端
- 🔧 **智能分段翻译**: 自动识别多条目内容，避免翻译遗漏
- 📚 **术语库扩充**: 新增大量专业术语，提升翻译准确性
- 🎯 **统一启动器**: 一键选择PC端或Web端模式

#### 🔧 功能优化
- 🚀 **性能提升**: C#版启动速度提升300%，内存占用降低50%
- 🎨 **界面美化**: 三个版本界面全面重设计，用户体验大幅提升
- 🔍 **翻译质量**: 新增翻译质量检查机制，自动检测内容遗漏
- � **实时监控**: Web版支持实时翻译进度推送
- 🌍 **局域网共享**: Web版支持多用户同时访问

#### �🐛 问题修复
- 修复Word表格复杂内容翻译遗漏问题
- 修复PDF文档格式保持问题
- 修复术语库编辑器的稳定性问题
- 修复Web端文件上传大小限制问题

#### 📖 文档完善
- 新增C#版使用说明
- 完善Web端部署指南
- 新增内网环境解决方案
- 更新API配置说明

### v3.0 (2025-06)
- 🔄 重构代码架构，模块化设计
- 🤖 新增多AI引擎支持（智谱AI、Ollama、硅基流动）
- 📈 优化翻译质量和速度
- 💫 改进用户体验和界面设计

## 📄 许可证

本项目采用专有许可证，需要授权码才能使用。

---

## 🎯 选择建议

| 使用场景 | 推荐版本 | 理由 |
|---------|---------|------|
| 个人专业用户 | Python PC端 | 功能最完整，支持所有高级特性 |
| 团队协作 | Python Web端 | 支持多用户，局域网共享 |
| Windows用户 | C# PC端 | 原生体验，性能最佳 |
| 企业内网 | Web端+内网OpenAI | 数据安全，可控部署 |
| 移动办公 | Python Web端 | 支持手机/平板访问 |

## 🔗 相关链接

- **智谱AI**: https://open.bigmodel.cn/
- **Ollama**: https://ollama.ai/
- **硅基流动**: https://siliconflow.cn/
- **技术支持**: 联系软件供应商

---

*多格式文档翻译助手 v3.1 - 让文档翻译更简单、更专业、更智能*
